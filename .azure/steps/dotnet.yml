steps:
  - task: UseDotNet@2
    displayName: 'Install .NET SDK 6.0.x'
    inputs:
      version: 6.0.x
      installationPath: $(Agent.ToolsDirectory)/dotnet

  - task: UseDotNet@2
    displayName: 'Install .NET SDK 7.0.x'
    inputs:
      version: 7.0.x
      installationPath: $(Agent.ToolsDirectory)/dotnet

  - script: |
      powershell -NoProfile -ExecutionPolicy unrestricted -Command "[Net.ServicePointManager]::SecurityProtocol = [Net.SecurityProtocolType]::Tls12; &([scriptblock]::Create((Invoke-WebRequest -UseBasicParsing 'https://dot.net/v1/dotnet-install.ps1'))) -Version 8.0.100-rtm.23478.7 -InstallDir $(Agent.ToolsDirectory)/dotnet
      dotnet --info
    displayName: 'Install .NET SDK 8 Preview'
    condition: eq(variables['Agent.OS'], 'Windows_NT')

  - script: |
      curl -sSL https://dot.net/v1/dotnet-install.sh | bash /dev/stdin --version 8.0.100-rtm.23478.7 --install-dir $(Agent.ToolsDirectory)/dotnet
      dotnet --info
    displayName: 'Install .NET SDK 8 Preview'
    condition: eq(variables['Agent.OS'], 'Linux')

  - script: >
      sudo apt-get install -y gnupg ca-certificates &&
      sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys 3FA7E0328081BFF6A14DA29AA6A19B38D3D831EF &&
      (echo "deb [signed-by=/usr/share/keyrings/mono-official-archive-keyring.gpg] https://download.mono-project.com/repo/ubuntu stable-focal main" | sudo tee /etc/apt/sources.list.d/mono-official-stable.list) &&
      sudo apt-get update &&
      sudo apt-get install -y mono-devel &&
      sudo apt-get install -y ca-certificates-mono
    displayName: 'Install Mono'
    condition: eq(variables['Agent.OS'], 'Linux')